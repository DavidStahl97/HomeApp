@page "/settings"

@attribute [Authorize]

@inject IWebAPIClient Client

<h3>Settings</h3>

<div class="mb-3">
    <label for="exampleInputEmail1" class="form-label">Komoot User Id</label>
    <input class="form-control" aria-describedby="emailHelp" @bind="@userSettings.KomootUserId" />
</div>
<button class="btn btn-primary" @onclick="@OnSubmitAsync">Submit</button>

<div class="mb-3">
    <label>Cookie</label>
    <input class="form-control" @bind="@komootToursRequest.Cookies" />
</div>
<button @onclick="OnUpdateKommotTourAsync">Update Komoot Tours</button>

@code {
    private UserSettingsDto userSettings = new UserSettingsDto();
    private KomootToursRequest komootToursRequest = new KomootToursRequest();


    protected override async Task OnInitializedAsync()
    {
        userSettings = await Client.SendAsync(x => x.GetUserSettingsAsync());
    }

    private async Task OnSubmitAsync()
    {
        await Client.SendAsync(x => x.PostUserSettingsAsync(userSettings));
    }

    private async Task OnUpdateKommotTourAsync()
    {
        await Client.SendAsync(x => x.PostToursAsync(komootToursRequest));
    }
}
